#!/usr/bin/env python3

import os
import json
import sys

FIFO_PATH = "/tmp/iterm_fifo"

def send_message(command, **kws):
    msg = json.dumps({
        'command': command,
        'kws': kws
    })
    try:
        out = os.open(FIFO_PATH, os.O_NONBLOCK | os.O_WRONLY)
    except OSError as e:
        print("Could not open FIFO.", e)
    else:
        os.write(out, bytes(msg, 'utf-8'))
        os.close(out)

send_message('window', cd=sys.argv[1])